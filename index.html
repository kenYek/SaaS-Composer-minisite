<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="The cloud based graphical control tool">
  <title>SaaS Composer</title>
  <link rel="stylesheet" type="text/css" href="./css/style.css">
  <link rel="apple-touch-icon" href="./assets/banner01.png">
  <link rel="icon" type="image/png" href="./assets/banner01.png">
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="zh_TW" />
  <meta property="og:title" content="SaaS Composer" />
  <meta property="og:description" content="The cloud based graphical control tool">
  <meta property="og:site_name" content="SaaS Composer">
  <meta property="og:image" content="./assets/banner01.png">
  <meta name="twitter:card" content="website">
  <meta name="twitter:title" content="SaaS Composer">
  <meta name="twitter:description" content="The cloud based graphical control tool">
  <!-- <meta name="twitter:site" content="帳號">
  <meta name="twitter:creator" content="作者"> -->
  <!-- <meta name="twitter:url" content="https://XXXX.com/XXXX.html"> -->
  <meta name="twitter:image" content="./assets/banner01.png">
</head>

<body>
  <div class="gradient-div"></div>
  <section id="bannerSection">
    <div class="container" id="bannerArea">
      <div class="banner-wrap">
        <h1>SaaS Composer FAQ</h1>
        <h2>Frequently Asked Question & Examples</h2>
      </div>
      <div class="banner-wrap-img">

      </div>
    </div>
  </section>
  <nav class="menu">
    <div class="container">
      <a href="#about">About</a> |
      <a href="#FAQ">Frequently Asked Question</a> |
      <a href="#Example">Examples</a>
      <a href="#reference">Reference</a>
      <button id="switchButton" class="isMainColor"></button>
    </div>
  </nav>
  <section id="about">
    <div class="container">
      <article>
        以下內容為 SaaS Composer 產品使用分享技術交流，可能依照版本不同而有使用上的差異。<br>
        SaaS Compoer 繪圖核心使用到 Hightopo SDK & 2D Editor & 3D Editor ，針對應用場域管理及數據綁定做二次開發加值。<br>
        由於使用的是標準網頁瀏覽器 javascript 語法與 canvas 技術，可以透過前端技術進行擴展開發客製的圖標、組件進行整合。<br>
      </article>
    </div>
  </section>
  <section id="FAQ">
    <div class="container">
      <h2>Frequently Asked Question</h2>
      <ul>
        <li>
          <h3>General</h3>
          <ul>
            <li><a href="#f01">如何取的物件(Node)的<mark>tag</mark></a></li>
            <li><a href="#f02">如何取的<mark>GraphView</mark>物件</a></li>
            <li><a href="#f03">如何取的圖紙、場景<mark>dataModel</mark></a></li>
            <li><a href="#f04">物件屬性改值</a></li>
            <li><a href="#f05">物件動態添加</a></li>
            <li><a href="#f06">物件動態添加事件</a></li>
            <li><a href="#f07">SVG顯示錯誤</a></li>
            <li><a href="#f08">導出匯出場景、圖紙時，失敗</a></li>
            <li><a href="#f09">元素屬性變化事件監聽器</a></li>
            <li><a href="#f10">數據綁定相關資訊，含 request、response</a></li>
            <li><a href="#f11">HTML DOM元素和 canvas上的繪制圖形是兩個不同的層，它們無法交錯層疊。</a></li>
            <li><a href="#f12">腳本語法僅支持： javascript</a></li>
            <li><a href="#f13">透過生成json產生圖紙及數據綁訂</a></li>
            <li><a href="#f14">資料綁定 Set Match ，設定顏色不要用 Direct feed</a></li>
            <li><a href="#f15">不同 view HTML 頁面功能對應</a></li>
            <li><a href="#f16">非數值型屬性綁定數據或動態填資料</a></li>
            <li><a href="#f17">不支持變量的數據源動態切換綁訂數據 </a></li>
            <li><a href="#f18">數據源的 datasourcetype 取得</a></li>
            <li><a href="#f19">Assets目錄支援格式</a></li>
          </ul>
        </li>
        <li>
          <h3>2D</h3>
          <ul>
            <li><a href="#f_2d_01">2D map、video 等，與繪制圖形是兩個不同的層，它們無法交錯層疊。</a></li>
            <li><a href="#f_2d_02">2D 事件無法觸發</a></li>
            <li><a href="#f_2d_03">2D 整合Echart第三方擴充套件</a></li>
            <li><a href="#f_2d_04">2D Table 圖標客製化欄位內容</a></li>
          </ul>
        </li>
        <li>
          <h3>3D</h3>
          <ul>
            <li><a href="#f_3d_01">圖紙步進距離設定</a></li>
            <li><a href="#f_3d_02">3D 貼皮重複 UV</a></li>
            <li><a href="#f_3d_03">3D 場景優化</a></li>
            <li><a href="#f_3d_04">3D 模型簡化</a></li>
            <li><a href="#f_3d_05">3D obj模型大小超過20m，如何壓縮呢？</a></li>
            <li><a href="#f_3d_06">3D 調適訊息，效能資訊顯示</a></li>
            <li><a href="#f_3d_07">3D 如何複製內建obj模型進行修改</a></li>
            <li><a href="#f_3d_08">3D FBX 模型動態置換材質</a></li>
          </ul>
        </li>
        <li>
          <h3>Overlay</h3>
          <ul>
            <li><a href="#f_layer_01">取得各層 graphview 或 dataModel</a></li>
          </ul>
        </li>
        <li>
          <h3>Data surce plugin</h3>
          <ul>
            <li><a href="#f_data_01">sourceFormPane 使用一般 html 設計</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </section>
  <section id="Example">
    <div class="container">
      <h2>Examples</h2>
      <ul>
        <li>
          <h3>2D</h3>
          <ul>
            <li><a href="#e_2d_01">2D 閃爍</a></li>
            <li><a href="#e_2d_02">2D 動態換圖</a></li>
            <li><a href="#e_2d_03">2D 船顯示方向</a></li>
            <li><a href="#e_2d_04">2D AR 手機相機互動</a></li>
            <li><a href="#e_2d_05">2D 錄音撥放</a></li>
            <li><a href="#e_2d_06">2D 輸入框讀值、改值</a></li>
            <li><a href="#e_2d_07">2D iframe 鑲入</a></li>
            <li><a href="#e_2d_08">2D 圖標捲動軸範例</a></li>
            <li><a href="#e_2d_09">2D 表格與分頁連動</a></li>
            <li><a href="#e_2d_10">2D 表格與分頁連動 2</a></li>
            <li>
              <h3>圖標</h3>
              <ul>
                <li><a href="#e_2d_s_01">整合Echart第三方擴充套件</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li>
          <h3>3D</h3>
          <ul>
            <li><a href="#e_3d_01">3D 水管流動</a></li>
            <li><a href="#e_3d_02">3D 物件改顏色</a></li>
            <li><a href="#e_3d_03">3D 機器手臂</a></li>
            <li><a href="#e_3d_04">3D 裁切</a></li>
          </ul>
        </li>
        <li>
          <h3>Overlay</h3>
          <ul>
            <li><a href="#e_overlay_01">疊加層遙控面板</a></li>
            <li><a href="#e_overlay_02">疊加層圓形拖拽遙控面板</a></li>
          </ul>
        </li>
        <li>
          <h3>Other</h3>
          <ul>
            <li><a href="#e_other_01">Product configuration Sample</a></li>
          </ul>
        </li>
      </ul> 
    </div>
  </section>
  <section id="FAQList">
    <div class="container">
      <h2>General</h2>
      <div class="ex-contain" id="f01">
        <h3>如何設定物件(Node)的 tag及取得物件</h3>
        <img class="ex-image" src="./assets/f01_01.png">
        <p>在物件屬性中進行設定 Tag. 若設定為 tag_name.</p>
        <div class="codeArea">
          <code>
            dataModel.getDataByTag('tag_name')
          </code>
        </div>
        <p>
          取得 Node data 的方式除了透過 tag 之外，在事件傳入的 "data"，也可直接獲取當前 Node Data。
        </p>
        <img class="ex-image" src="./assets/f01_02.png">
      </div>
      <div class="ex-contain" id="f02">
        <h3>如何取的<mark>GraphView</mark>物件</h3>
        <p>
          In 2D page (display.html) : graphView<br>
          In 3D page (scene.html) : g3d<br>
          In Overlay page (sceneAndDisplay.html) : graphView or g3d<br>
          Or<br>
          commonViewUtil.getFileObjByFileName(dataRefreshUtil.currentFile).graphView<br>
          或是在每個事件 function 中傳入的 "gv"、"view"<br>
          使用疊加層時盡量使用事件函數傳入的 graphview.
        </p>
      </div>
      <div class="ex-contain" id="f03">
        <h3>如何取的圖紙、場景<mark>dataModel</mark></h3>
        <p>
          In 2D page (display.html) : dataModel<br>
          In 3D page (scene.html) : dataModel<br>
          In Overlay page (sceneAndDisplay.html) : dataModel<br>
          Or<br>
          commonViewUtil.getFileObjByFileName(dataRefreshUtil.currentFile).dataModel<br>
          或是在每個事件 function 中傳入的 "dm"<br>
          或是從 graphview 物件下使用 graphview.dm()<br>
          使用疊加層時盡量使用事件函數傳入的 graphview 或是 dm.
        </p>
      </div>
      <div class="ex-contain" id="f04">
        <h3>物件屬性改值</h3>
        <img class="ex-image" src="./assets/f04_01.png">
        <p>
          可透過 dataModel.getDataByTag('tag_name') 取得物件，物件屬姓分為 property(p), style(s), attribute(a)，
          使用以下取的當前值：<br>
          dataModel.getDataByTag('tagName').s('style_name')<br>
          dataModel.getDataByTag('tagName').a('attribute_name')<br>
          dataModel.getDataByTag('tagName')[ht.Default.getter('property_name')](); <br>
          使用以下設定當前值：<br>
          dataModel.getDataByTag('tagName').s('style_name', value)<br>
          dataModel.getDataByTag('tagName').a('attribute_name', value)<br>
          dataModel.getDataByTag('tagName')[ht.Default.getter('property_name')](value); <br>
        </p>
      </div>
      <div class="ex-contain" id="f05">
        <h3>物件(圖標)動態添加</h3>
        <textarea disabled style="width:100%;resize: none;" rows="12">
          添加文字  
            var d = new ht.Text()
            d.s('text','AAA')
            dataModel.add(d)

          添加圖標  
            var node = new ht.Node();
            node.setImage('symbols/builtIn/fan/fan3.json'); // 加入圖標路徑  
            node.p({x:200,y:200})
            dataModel.add(da)
        </textarea>
      </div>
      <div class="ex-contain" id="f06">
        <h3>物件動態添加事件</h3>
        <textarea disabled style="width:100%;resize: none;" rows="6">
          node.s({
            'interactive': true,
            'onClick': function(event, data, view) {
            }
          })
        </textarea>
      </div>
      <div class="ex-contain" id="f07">
        <h3>SVG顯示錯誤</h3>
        <p>
          SVG 中的內容如果不是向量圖形，而是 `image` 這種多png組成的，
          在添加入HT編輯器時可能會出現無法顯示，進入到瀏覽模式時會看不見這張 svg。  
          此時請直接使用 png 進行貼圖。  
        </p>
        <textarea disabled style="width:100%;resize: none;" rows="6">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="997" height="1217" viewBox="0 0 997 1217">
            <image id="图层_2" data-name="图层 2" x="111" y="62" width="742" height="1088" xlink:href="data:img/png;base64"/>
          </svg>
        </textarea>
      </div>
      <div class="ex-contain" id="f08">
        <h3>導出匯出場景、圖紙時，失敗</h3>
        <p>
          1. 如果只有特定圖紙無法匯出，可能是圖紙上物件中含有亂碼造成無法解析，請找出並移除該物件。<br>
          2. 如果是所有圖紙均無法匯出，可能是部屬空間資源不足。需要請平台調整部屬資源。<br>
        </p>
      </div>
      <div class="ex-contain" id="f09">
        <h3>元素屬性變化事件監聽器</h3>
        <textarea disabled style="width:100%;resize: none;" rows="11">
          dataModel.md(function(event) {
            //event格式：
            {
              property: "name",//发生变化的属性
              data: data,//属性发生变化的data
              oldValue: 0,//旧值
              newValue: 1//新值
            }
          });
        </textarea>
      </div>
      <div class="ex-contain" id="f10">
        <h3>Viewer 數據綁定相關資訊，含request、response</h3>
        <img class="ex-image" src="./assets/f10_01.png">
        <textarea disabled style="width:100%;resize: none;" rows="11">
          // 使用已下可讀取到當前所有開啟過的圖紙數據綁定設定
          dataRefreshUtil.filesMap
          // 對應當前圖紙名稱
          dataRefreshUtil.currentFile
          // 收集所有數據綁定對照(上圖中)  
          collectSource
          // 發送取值前request整理(上圖中)
          reqCollect
          // 數據回應的response儲存(上圖中)  
          resCollect
        </textarea>
      </div>
      <div class="ex-contain" id="f11">
        <h3>HTML DOM元素和 canvas上的繪制圖形是兩個不同的層，它們無法交錯層疊。</h3>
        <textarea disabled style="width:100%;resize: none;" rows="15">
HTML DOM（文檔對象模型）元素是網頁中的HTML元素，如文本、圖像、按鈕等，它們是由HTML代碼創建的並且可以通過CSS樣式進行布局和樣式化。而<canvas>元素是一個HTML5提供的元素，它是一個繪圖區域，可以通過JavaScript繪制2D圖形、圖像和動畫。
簡而言之，HTML DOM元素和<canvas>上的繪制圖形是兩個不同的層，它們無法交錯層疊。具體原因是因為HTML DOM元素是由HTML代碼創建並渲染的，它們是瀏覽器的文檔對象的一部分。而<canvas>元素是一個特殊的繪圖區域，它是通過JavaScript繪制的，繪制的內容與HTML文檔無關，也無法直接與HTML DOM元素進行交互。
如果想要在<canvas>上繪制與HTML DOM元素交互的圖形，可以使用JavaScript繪制的方法，例如使用繪制庫（如Canvas API）來實現繪圖效果，並通過JavaScript來響應用戶交互。但是，繪制在<canvas>上的圖形不會影響到HTML DOM元素，它們仍然是分開的兩個層級，無法直接交錯疊加。
因此，如果想要在頁面中同時使用HTML DOM元素和<canvas>繪制圖形，需要將它們分別放置在不同的位置，並理解它們是兩個獨立的層，無法直接交錯疊加。
        </textarea>
      </div>
      <div class="ex-contain" id="f12">
        <h3>腳本語法僅支持：javascript</h3>
        <p>
          頁面完全使用標準html, javascript語法，依瀏覽器支援進行渲染。<br>
          所有的開發技術請參考Javascript前端網頁進行學習。<br>
        </p>
      </div>
      <div class="ex-contain" id="f13">
        <h3>透過生成json產生圖紙及數據綁訂</h3>
        <img class="ex-image" src="./assets/f13_01.png">
        <p>
          可將相關物件配置完成後，複製右下角的數據進行查看各屬性資訊。<br>
          依json格式生成新的json即可。<br>
        </p>
        <textarea disabled style="width:100%;resize: none;" rows="13">
          使用api上傳可以呼叫 "POST /upload"
          Body:
          {
            path: scenes/****.json,
            content: { **數據json** }
          }
          注意需要登入"POST　/api/login"後取得token才能呼叫驗證成功
          {
            "password": "******",
            "username": "******"
          }
        </textarea>
      </div>
      <div class="ex-contain" id="f14">
        <h3>資料綁定 Set Match，設定顏色不要用Direct feed</h3>
        <p>
          Direct feed 的功能是為了快速處理 0,1 與 true, false 對應使用<br>
          0 => false<br>
          1 => true<br>
          勾選 direct feed 則不需額外配置 treu, false
        </p>
      </div>
      <div class="ex-contain" id="f15">
        <h3>不同 view HTML 頁面功能對應</h3>
        <div>
          <table>
            <thead>
              <tr>
                <th>HTML</th>
                <th>功能</th>
                <th>說明</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>display.html</td>
                <td>2D 顯示</td>
                <td>2D 預設預覽</td>
              </tr>
              <tr>
                <td>scene.html</td>
                <td>3D 顯示</td>
                <td>3D 預設預覽</td>
              </tr>
              <tr>
                <td>sceneAndDisplay.html</td>
                <td>2D & 3D 疊加層顯示</td>
                <td>預設預覽、選單開啟疊加層</td>
              </tr>
              <tr>
                <td>view.html</td>
                <td>2D 或 3D 顯示</td>
                <td>選單預設，未開啟疊加層</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="ex-contain" id="f16">
        <h3>非數值型屬性綁定數據或動態填資料</h3>
        <img class="ex-image" src="./assets/f16_01.png"><br/>
        <p>
          以下拉選單為例，需要的格式是 (label, value) 陣列資料。<br>
          可透過 script 動態填入相同格式的 json，達到動態換資料。<br>
          即可透過 fetch, XMLHttpRequest 等方式動態改動下拉選單內容
        </p>
        <textarea disabled style="width:100%;resize: none;" rows="5">
          data.a('ht.dataSource', [
            { 'label': 'tag 1', value: 'tag_name_1' },
            { 'label': 'tag 2', value: 'tag_name_2' }
          ])
        </textarea>
      </div>
      <div class="ex-contain" id="f17">
        <h3>不支持變量的數據源動態切換綁訂數據</h3>
        <p>
          1. 在 Userdefined 的數據綁定中，預先定義可能會使用到被切換的數據，以便在取值時會預先讀取。 <br>
          2. 在綁定的數據的彈窗屬性裡修改"id"，在標簽頁 Information > id。本例中修改為 test_change <br>
          3. 修改物件綁定的數據物件：
        </p>
        <textarea disabled style="width:100%;resize: none;" rows="15">
          dataRefreshUtil.filesMap.forEach((item) => {
            if (dataRefreshUtil.currentFile === item.filename) {
                item.collectSource.forEach((obj) => {
                    if (obj.db.id === 'test_change') {
                        if (obj.db.targets[0].target === 'upper_0') {
                            obj.db.targets[0] = {sourceType: 'SimpleJson', formatType: 'timeseries', scDataType: 'value', target: 'upper_1'};
                        } else {
                            obj.db.targets[0] = {sourceType: 'SimpleJson', formatType: 'timeseries', scDataType: 'value', target: 'upper_0'};
                        }
                        console.log(obj.db.id, obj.db.targets[0].target)
                    }
                })
            }
          })
        </textarea>
        <p>
          修改 dataRefreshUtil.filesMap 中的 collectSource，找到對應物件的 ***target*** 並進行修改。 <br> 
          注意：不同數據源的 targets 物件格式可能不同，請依照個數據源參數進行改寫。  <br>

          target物件中的必要欄位：  <br>
          - sourceType  <br>
          - formatType  <br>
          - scDataType  <br>
          - target  <br>
        </p>
        <img class="ex-image" src="./assets/f17_01.png"><br/>
        <img class="ex-image" src="./assets/f17_02.png"><br/>
      </div>
      <div class="ex-contain" id="f18">
        <h3>數據源的 datasourcetype 取得</h3>
        <img class="ex-image" src="./assets/f18_01.png"><br/>
        <p>
          在 Data source 列表中，點擊 "i" 會自動複製 datasourcetype。<br>
          這個名稱是數據源唯一識別 "id" 。<br>
          ※ datasourceName 則是用戶自定義的名稱
        </p>
      </div>
      <div class="ex-contain" id="f19">
        <h3>Assets目錄支援格式</h3>
        <p>
          媒體類型：
        </p>
        <ul>
          <li>png</li>
          <li>gif</li>
          <li>jpg</li>
          <li>jpeg</li>
          <li>svg</li>
          <li>mp3</li>
          <li>mp4</li>
          <li>dxf</li>
          <li>obj</li>
          <li>mtl</li>
          <li>3ds</li>
          <li>bin</li>
          <li>fbx</li>
          <li>hdr</li>
          <li>gltf</li>
          <li>glb</li>
        </ul>
        <p>
          文字類型：
        </p>
        <ul>
          <li>json</li>
          <li>cob</li>
          <li>htb</li>
          <li>js</li>
          <li>css</li>
          <li>html</li>
          <li>htm</li>
        </ul>
      </div>
      <h2>2D</h2>
      <div class="ex-contain" id="f_2d_01">
        <h3>2D map、video 等，與繪制圖形是兩個不同的層，它們無法交錯層疊。</h3>
        <textarea disabled style="width:100%;resize: none;" rows="15">
HTML DOM （文檔對象模型）元素是網頁中的 HTML 元素，如文本、圖像、按鈕等，它們是由 HTML 代碼創建的並且可以通過CSS樣式進行布局和樣式化。而<canvas>元素是一個 HTML5 提供的元素，它是一個繪圖區域，可以通過 JavaScript 繪制 2D 圖形、圖像和動畫。
簡而言之， HTML DOM 元素和 <canvas> 上的繪制圖形是兩個不同的層，它們無法交錯層疊。具體原因是因為 HTML DOM 元素是由 HTML 代碼創建並渲染的，它們是瀏覽器的文檔對象的一部分。而 <canvas> 元素是一個特殊的繪圖區域，它是通過 JavaScript 繪制的，繪制的內容與 HTML 文檔無關，也無法直接與 HTML DOM 元素進行交互。
如果想要在<canvas>上繪制與 HTML DOM 元素交互的圖形，可以使用 JavaScript 繪制的方法，例如使用繪制庫（ 如Canvas API ）來實現繪圖效果，並通過 JavaScript 來響應用戶交互。但是，繪制在 <canvas> 上的圖形不會影響到 HTML DOM 元素，它們仍然是分開的兩個層級，無法直接交錯疊加。
因此，如果想要在頁面中同時使用 HTML DOM 元素和<canvas>繪制圖形，需要將它們分別放置在不同的位置，並理解它們是兩個獨立的層，無法直接交錯疊加。
        </textarea>
      </div>
      <div class="ex-contain" id="f_2d_02">
        <h3>2D 事件無法觸發</h3>
        <textarea disabled style="width:100%;resize: none;" rows="4">
          點擊事件或其他事件無法被觸發，請確認物件是否有啟用。可交互(interactive)。
          如果只是針對單一事件無法觸發，請透過瀏覽器開發者工具確認是否有語法撰寫錯誤情況發生。
        </textarea>
      </div>
      <div class="ex-contain" id="f_2d_03">
        <h3>2D 整合Echart第三方擴充套件</h3>
        <p>第三方圖形可以參考: <a href="https://www.isqqw.com/" target="_blank">Echart Demo</a></p>
        <img class="ex-image" src="./assets/f_2d_03_01.png">
        <p>
          在設定頁引入第三方套件。<br/>
          https://cdn.jsdelivr.net/npm/echarts-liquidfill@3/dist/echarts-liquidfill.min.js<br>
        </p>
        <img class="ex-image" src="./assets/f_2d_03_02.png"><br/>
        <p>
          新建圖標，並且在<mark>Render HTML</mark>撰寫相關引用 Echart 的代碼，及設定可數據綁定的參數<br>
          在圖指引用之後即可在預覽時呈現。<br>
          需要注意 Echart 是使用獨立的 HTML 元件，不可與繪製的圖進行交錯排列。
        </p>
        <textarea disabled style="width:100%;resize: none;" rows="10">
    let value = data.a('value');
    if (value > 1) {
        value = (value % 100) / 100;
    } else if (value < 0) {
        value = 0
    }

    var option = {
      backgroundColor: '#fff',
      title: {
        left: 'center',
        bottom: 20,
        text: '申请方',
        textStyle: {
          fontWeight: 'bold',
          fontSize: 25,
          color: '#333'
        },
        subtext: '满意度',
        subtextStyle: {
          color: '#333'
        }
      },
      series: [
        {
          type: "liquidFill",
          name: '申请方',
          radius: "85%",
          center: ['50%', '45%'],
          shape: "path://M657.462,490.835c-21.359-45.771-82.071-35.092-82.471,18.032-0.221,29.177,28.91,40.083,48.306,51.747,18.807,11.312,32.193,26.786,34.291,33.373,1.8-6.454,16.705-22.366,34.115-33.689,19.036-12.382,48.527-22.572,48.306-51.748C739.607,455.294,677.839,446.889,657.462,490.835Z",
          data: [value, value, value], //datat
          color: ['#fc8b8b'],
          outline: {
            show: false,
          },
          backgroundStyle: {
            color: '#edd4d4',
            borderColor: "#fff",
            borderWidth: 1,
            shadowColor: "rgba(0, 0, 0, 0.4)",
            shadowBlur: 0,
          },
          label: {
            normal: {
              position: ["50%", "40%"],
              formatter: () => {
                return Math.round(value * 100) + '%'
              },
              textStyle: {
                fontSize: 30,
              },
            },
          },
        },
      ],
    };

    if (!cache.htmlView) {
        cache.htmlView = document.createElement('div');
        cache.htmlView.style.position = 'absolute';
        cache.htmlChart = echarts.init(cache.htmlView);

        // layoutHTML will be called when the data needs to be drawing
        cache.htmlView.layoutHTML = function() {
            gv.layoutHTML(data, cache.htmlView, false);
            cache.htmlChart.resize();
        };
    }

    // update data
    option.color = [data.a('lineColor1'), data.a('lineColor2')];
    option.textStyle = { color: data.a('textColor') };
    cache.htmlChart.setOption(option);

    // html for showing
    return cache.htmlView;
        </textarea>
      </div>
      <div class="ex-contain" id="f_2d_04">
        <h3>2D Table 圖標客製化欄位內容</h3>
        <p>
          可參考內漸圖紙： displays/builtIn/table.json<br>
        </p>
        <img class="ex-image" src="./assets/f_2d_04_01.png">
        <p>
          或是參考 Technical Documentation
          <a href="https://docs.wise-paas.advantech.com/en/Guides_and_API_References/ApplicationServices/SaaS_Composer/1649740919078715559/v3.1.8" target="_blank">
            表格章節
          </a>
        </p>
      </div>
      <h2>3D</h2>
      <div class="ex-contain" id="f_3d_01">
        <h3>圖紙步進距離設定</h3>
        <textarea disabled style="width:100%;resize: none;" rows="4">
          g3d.setMoveStep(number)
          g3d.getMoveStep()
        </textarea>
      </div>
      <div class="ex-contain" id="f_3d_02">
        <h3>3D 貼皮重複 UV</h3>
        <p>
          要正確貼皮，圖片大小有限制，
          贴图大小要是2的n次方，如: 128 * 256  
        </p>
      </div>
      <div class="ex-contain" id="f_3d_03">
        <h3>3D 場景優化</h3>
        <p>
          場景可以從以下幾個方面優化：  <br>
          1、讓設計師輕量化模型，對模型進行減面，不必要的細節不要精細建模，使用貼圖代替，ht的3d場景模型總面數不建議超過 200 萬面。  <br>
          2、做批量優化：https://www.hightopo.com/guide/guide/core/batch/ht-batch-guide.html  <br>
          3、節點做矢量緩存 node.s('texture.cache',true) <br>
        </p>
      </div>
      <div class="ex-contain" id="f_3d_04">
        <h3>3D 模型簡化</h3>
        <p>
          Web 上撐不住那麽大模型，哪怕純裸寫 WebGL 繪制三角面極限也就在哪里，這種情況有幾條路： <br> 
          1、簡化模型，這是最有效的，我們大部分外包的項目模型都會重新設計  <br>
          2、業務分級，例如數據中心，打開機櫃再顯示里面的服務器和端口細節  <br>
          3、算法上簡模的定制化<br>
          官網例子的模型基本都沒超過 10m，單個設備一般構建在 m 以內，甚至小到幾10k，定位的大部分還是運維的系統，用戶只需要看得清是個什麽樣的設備即可。 <br> 
          所以大部分情況下，用戶說有模型可以給我們用的項目，一般都可以直接告訴客戶，現有的模型只能做參考，<br>
          大部分情況下我們需要重新建模，因為用戶手頭的模型基本都是 SolidWorks 之類的工程建模模型，是非常精確的為了可制造生產的建模精度，但作為運維一般會極大的簡化建模。 <br>        
        </p>
      </div>
      <div class="ex-contain" id="f_3d_05">
        <h3>3D obj模型大小超過20m，如何壓縮呢？ </h3>
        <p>
          模型的大小是由模型的面數控制的，面數和模型大小成正比，需要設計師在建模軟件中對模型進行減面處理。<br>        
        </p>
      </div>
      <div class="ex-contain" id="f_3d_06">
        <h3>3D 調適訊息，效能資訊顯示</h3>
        <textarea disabled style="width:100%;resize: none;" rows="6">
          // 2D
          graphView.showDebugTip();
          // 3D
          graph3dView.showDebugTip();
        </textarea>
      </div>
      <div class="ex-contain" id="f_3d_07">
        <h3>3D 如何複製內建obj模型進行修改。 </h3>
        <img class="ex-image" src="./assets/f_3d_07_01.png">
        <p>
          開啟模型，依照模型路徑至assets目錄下將檔案匯出即可進行修改。<br>    
          修改完成之後，請重新建立新的Model。<br>    
          對應的貼皮圖檔紀錄在mtl檔中，需先下載後再找對應的檔案。<br> 
        </p>
      </div>
      <div class="ex-contain" id="f_3d_08">
        <h3>3D FBX 模型動態置換材質。 </h3>
        <img class="ex-image" src="./assets/f_3d_08_01.png">
        <p>
          一般方式如果要置換模型材質需要動態產生模型，給予材質，並在場景上取代舊模型<br>
          比較簡易的方式是針對 Node 進行屬性替換，針對 <mark>matDef</mark> 屬性修改。<br>
          matDef 中的 key 值為 fbx 內部定義。
        </p>
        <textarea disabled style="width:100%;resize: none;" rows="6">
          dataModel.getDataByTag('aaa').s(
            'matDef',
            { 
              外墙: "materials/builtIn/building/brickPillar.json"
            }
          )
        </textarea>
      </div>
      <h2>Overlay</h2>
      <div class="ex-contain" id="f_layer_01">
        <h3>取得各層 graphview 或 dataModel</h3>
        <img class="ex-image" src="./assets/f_overlay_01_01.png">
        <img class="ex-image" src="./assets/f_overlay_01_02.png">
        <textarea disabled style="width:100%;resize: none;" rows="6">
          可以透過每個事件function中傳入的gv,view,dm等參數取得。  
          graph2d = gv;
          之後可以從全域變數中提取，此方法可以避免因檔案複製路徑檔名不同而需要修改的問題。
          其次，可透過全域變數 "commonViewUtil.currentFiles" 取得當前所有開啟的圖紙場景物件，
          包含 graphView 與 dataModel ，使用此方式需要知道要操控的是哪個疊加層檔案名稱。
        </textarea>
      </div>
      <h2>Data surce plugin</h2>
      <div class="ex-contain" id="f_data_01">
        <h3>sourceFormPane 使用一般 html 設計</h3>
        <p>例如添加連結 a</p>
        <textarea disabled style="width:100%;resize: none;" rows="8">
          var href = document.createElement('a');
          href.setAttribute('href', 'http://www.******.com');
          href.innerHTML = 'http://www.*****.com';
          href.style.font = sourceFormPane.getLabelFont();
          href.style.lineHeight = sourceFormPane.getRowHeight() + 'px';
          href.style.textAlign = 'right';
          sourceFormPane.addRow([href], [0.1]);
        </textarea>
        <p>
          dataBindingUI ，使用 input & datalist 做測點下拉篩選功能<br>
        </p>
        <textarea disabled style="width:100%;resize: none;" rows="8">
          var div = document.createElement('div');
          div.id = 'divID';
          var input = document.createElement('input');
          input.type = 'text';
          input.style.font = sourceFormPane.getLabelFont();
          input.style.height = sourceFormPane.getRowHeight() + 'px';
          input.style.lineHeight = sourceFormPane.getRowHeight() + 'px';
          input.id = 'testInput';
          input.setAttribute('list', 'tags');
          input.addEventListener('input', (e) => {
              const userInput = e.target.value;
              console.log(userInput)
              const tagsDatalist = document.getElementById('tags');
              const options = tagsDatalist.querySelectorAll('option');
              options.forEach(option => {
                  if (option.value.indexOf(userInput) === -1) {
                    option.style.display = 'none';
                  } else {
                    option.style.display = 'block';
                  }
              });
          });
          const tags = [
              'dv_tag_01',
              'adam_tag_01',
              'iot_tag_01',
              'wise_tag_01'
          ];
          var datalist = document.createElement('datalist');
          datalist.id = 'tags';
          tags.forEach(city => {
              const option = document.createElement('option');
              option.value = city;
              datalist.appendChild(option);
          });
          div.appendChild(input);
          div.appendChild(datalist);
          sourceFormPane.addRow([{
              element: ''
          }, {element: div, id: 'divID'}], [55, 0.1]);
        </textarea>
        <p>
          applyDataBindingUI 時需要將對應的值讀取返回到 target 物件下存取。
        </p>
        <textarea disabled style="width:100%;resize: none;" rows="8">
          var targets = [];
          target.tags = document.getElementById('testInput').value;
          targets.push(target);
          return targets;
        </textarea>
      </div>
    </div>
  </section>
  <section id="ExampleList">
    <div class="container">
      <div class="ex-contain" id="e_2d_01">
        <h3>2D 閃爍</h3>
        <a href="./example/e_2d_01.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_2d_02">
        <h3>2D 動態換圖</h3>
        <img class="ex-image" src="./assets/e_2d_02_01.png"><br/>
        <a href="./example/e_2d_02.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_2d_03">
        <h3>2D 船顯示方向</h3>
        <img class="ex-image" src="./assets/e_2d_03_01.png"><br/>
        <a href="./example/e_2d_03.zip" target="_blank">Download</a>
        <p>
          需要數據源：  <br>
          一般地圖座標 [“經度, 緯度”, timestamp] <br> 
          目前寫法是直接修改格式多添加方向  [“經度, 緯度, 方向角度”, timestamp]   <br>
        </p>
        <p>開啟場景中加入:</p>
        <textarea disabled style="width:100%;resize: none;" rows="10">
          window.LeafIcon = L.Icon.extend({
            options: {
                // shadowUrl: 'assets/leaf-orange.png?org_id=9',
                iconSize:     [50, 50],
                iconAnchor:   [0, 0],
                popupAnchor:  [-3, -76],
                degrees: 45
            },
            // PROPERTIES
          x: 66,
          y: 85,
          x_fac: 0.18,
          y_fac: 0.18,
          ctx: null,
          lastHeading: 0,
          lastWindDirection: 0,
            createIcon: function () {
            var s = this.options.iconSize;
                const canvas = document.createElement('canvas')
                canvas.width = 100;
                canvas.height = 100;
                canvas.style.width = 100 + 'px'
                canvas.style.height = 100 + 'px'
                canvas.style.marginLeft = '-25px';
                canvas.style.marginTop  = '-25px';
                var ctx = canvas.getContext("2d");
                ctx.save();
                ctx.translate(s[0] / 2, s[1] / 2);
                ctx.rotate(this.options.degrees * Math.PI / 180);
                ctx.restore();
                ctx.strokeStyle = '#FF0000'
                ctx.beginPath();
                var theta = this.options.degrees * Math.PI / 180
                var theta120 = 120 * Math.PI / 180
                var r = Math.min(s[0], s[1]) / 2
                var dx = r * Math.cos(theta)
                var dy = r * Math.sin(theta)
                var dx1 = r * Math.cos(theta - theta120)
                var dy1 = r * Math.sin(theta - theta120)
                var dx2 = r * Math.cos(theta + theta120)
                var dy2 = r * Math.sin(theta + theta120)
                ctx.moveTo(25 + dx, 25 + dy);
                ctx.lineTo(25 + dx1, 25 + dy1);
                ctx.lineTo(25, 25);
                ctx.lineTo(25 + dx2, 25 + dy2);
                ctx.closePath();
                ctx.fill();
                ctx.stroke();
                return canvas;
            }
          });
          
          
          window.changeStringtoMapArray = function(strArray){
            var geographicArrays = []
            if (Array.isArray(strArray)){
              strArray.forEach(element => {
                var arr = element.split(',')
                geographicArrays.push([arr[1],arr[0],arr[2]])
                // geographicArrays.push([arr[0],arr[1]])
              });
            }
            return geographicArrays
          }
          
          window.boatMarker = function(leafletMap, markerLayer, data, jsonData, infomation, open){
              var d = changeStringtoMapArray(data);
              var degree = (d[d.length - 1] && d[d.length - 1][2]) ? d[d.length - 1][2] : 0
              var a0 = (d[d.length - 1] && d[d.length - 1][0]) ? d[d.length - 1][0] : 0
              var a1 = (d[d.length - 1] && d[d.length - 1][1]) ? d[d.length - 1][1] : 0
              var greenIcon = new LeafIcon({degrees: degree})
              var marker = L.marker([a0, a1], {icon: greenIcon}).addTo(markerLayer);
              if (infomation){
                  marker.bindPopup(infomation)
              }
              if (open) marker.openPopup();
              return marker;
          }
        </textarea>
      </div>
      <div class="ex-contain" id="e_2d_04">
        <h3>2D AR 手機相機互動</h3>
        <img class="ex-image" src="./assets/e_2d_04_01.png"><br/>
        <a href="./example/e_2d_04.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_2d_05">
        <h3>2D 錄音撥放</h3>
        <img class="ex-image" src="./assets/e_2d_05_01.png"><br/>
        <a href="./example/e_2d_05.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_2d_06">
        <h3>2D 輸入框讀值、改值</h3>
        <img class="ex-image" src="./assets/e_2d_06_01.png"><br/>
        <a href="./example/e_2d_06.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_2d_07">
        <h3>2D iframe 鑲入</h3>
        <img class="ex-image" src="./assets/e_2d_07_01.png"><br/>
        <a href="./example/e_2d_07.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_2d_08">
        <h3>2D 圖標捲動軸範例</h3>
        <img class="ex-image" src="./assets/e_2d_08_01.png"><br/>
        <p>
          主要是靠圖標 scroll事件進行捲動與重畫 <mark>data.iv()</mark>
        </p>
        <a href="./example/e_2d_08.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_2d_09">
        <h3>2D 表格與分頁連動</h3>
        <img class="ex-image" src="./assets/e_2d_09_01.png"><br/>
        <p>
          1. 將表格與分頁組件添加至同一個圖標。<br>  
          2. 將分頁器的total屬性與跟表格的 datasource屬性關聯。<br>
          3. 將表格datasource與分頁作關聯<br>
          4. 在圖紙上進行數據輸入
        </p>
        <img class="ex-image" src="./assets/e_2d_09_02.png"><br/>
        <img class="ex-image" src="./assets/e_2d_09_03.png"><br/>
        <a href="./example/e_2d_09.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_2d_10">
        <h3>2D 表格與分頁連動 2</h3>
        <img class="ex-image" src="./assets/e_2d_09_01.png"><br/>
        <p>
          與外部資料連動<br>
          1. 將表格與分頁組件添加至同一個圖標。<br>
          2. 在圖紙上， onPostDeserialize 中設定 total總數<br>
          3. 在圖紙上， onChange 事件切換表格 datasource
        </p>
        <a href="./example/e_2d_10.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_2d_s_01">
        <h3>整合Echart第三方擴充套件</h3>
        <img class="ex-image" src="./assets/f_2d_03_02.png"><br/>
        <a href="./example/e_2d_s_01.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_3d_01">
        <h3>3D 水管流動</h3>
        <textarea disabled style="width:100%;resize: none;" rows="10">
        主要是修改貼皮的offset
        1. 使用管線 tag = line
        2. 設定貼皮
        3. 在執行期間：
        if(!window.offset) {window.offset = 0}
        window.offset = window.offset > 0 ? 0 : 0.1
        dataModel.getDataByTag('line').s('shape3d.uv.offset', [window.offset, 0])
        </textarea>
        <img class="ex-image" src="./assets/e_3d_01_01.png"><br/>
        <p>
          <a href="./example/e_3d_01_01.zip" target="_blank">Download</a>
        </p>
        <img class="ex-image" src="./assets/e_3d_01_02.png"><br/>
        <p>
          <a href="./example/e_3d_01_02.zip" target="_blank">Download</a>
        </p>
      </div>
      <div class="ex-contain" id="e_3d_02">
        <h3>3D 物件改顏色</h3>
        <img class="ex-image" src="./assets/e_3d_02_01.png"><br/>
        <a href="./example/e_3d_02.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_3d_03">
        <h3>3D 機器手臂</h3>
        <img class="ex-image" src="./assets/e_3d_03_01.png"><br/>
        <p>
          透過與父代的關聯進行連動
        </p>
        <a href="./example/e_3d_03.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_3d_04">
        <h3>3D 裁切</h3>
        <img class="ex-image" src="./assets/e_3d_04_01.png"><br/>
        <img class="ex-image" src="./assets/e_3d_04_02.png"><br/>
        <p>
          1. 設定裁切與被裁切的物件<br>
          2. 被裁切的物件上可以選擇 Mask ，被那些裁切組影響。<br>
          3. 裁切體物件上可設定屬於哪個裁切組、保留外部或內部<br>
          4. 記得將裁切體物件設置為不可見。
        </p>
        <a href="./example/e_3d_04.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_overlay_01">
        <h3>疊加層遙控面板</h3>
        <img class="ex-image" src="./assets/e_overlay_01.png"><br/>
        <a href="./example/e_overlay_01.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_overlay_02">
        <h3>疊加層圓形拖拽遙控面板</h3>
        <img class="ex-image" src="./assets/e_overlay_02.png"><br/>
        <p>本範例只提供可拖拽的圖標圖紙，可參考前例改寫</p>
        <a href="./example/e_overlay_02.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain" id="e_other_01">
        <h3>Product configuration Sample</h3>
        <p>可參考本例改寫，修改 UI 上配置</p>
        <img class="ex-image" src="./assets/e_other_01.png"><br/>
        <a href="./example/productConfig.zip" target="_blank">Download</a>
      </div>
      <div class="ex-contain"></div>
    </div>
  </section>
  <section id="reference">
    <div class="container">
      <article>
        <h2>Reference</h2>
        <ul>
          <li>
            <a href="https://docs.wise-paas.advantech.com/en/Guides_and_API_References/ApplicationServices/SaaS_Composer/1641432206032601142/v3.1.5" target="_blank">
              <span>Technical Documentation</span>
            </a>
          </li>
          <li><a href="https://www.w3schools.com/js/default.asp" target="_blank">w3schools JavaScript Tutorial</a></li>
          <li><a href="https://www.w3schools.com/graphics/canvas_intro.asp" target="_blank">w3schools Canvas Tutorial</a></li>
          <li><a href="https://www.w3schools.com/html/html5_canvas.asp" target="_blank">w3schools Canvas Graphics</a></li>
          <li><a href="https://www.hightopo.com/index.html" target="_blank">HT 图扑软件</a></li>
          <li><a href="https://hightopo.com/guide/sdkeditor/#/zh/editor/" target="_blank">HT 編輯器使用</a></li>
          <li><a href="https://www.hightopo.com/guide/guide/core/treetableview/examples/example_structure.html" target="_blank">HT 範例手冊</a></li>
          <li><a href="https://www.hightopo.com/guide/doc/" target="_blank">HT API查詢頁面</a></li>
          <li><a href="https://hightopo.com/guide/sdkeditor/#/zh/SDK/" target="_blank">HT SDK 物件結構 & HT widget</a></li>
          <li><a href="https://hightopo.com/ui/guide/zh/nav.html" target="_blank">HT UI範例手册导航</a></li>
          <li><a href="https://hightopo.com/ui/jsdoc/zh/" target="_blank">HT UI API 文件</a></li>
          <li><a href="https://hightopo.com/guide/sdkeditor/#/zh/UI/README" target="_blank">HT 入门手册</a></li>
        </ul>
      </article>
    </div>
  </section>
  <!-- Scroll to Top Button -->
  <div id="scrollToTopBtn" onclick="scrollToTop()">
    &#8679;
  </div>
  <script src="./js/main.js"></script>
</body>

</html>